services:
  - type: web
    name: skyline-style
    env: python
    region: oregon
    plan: free
    branch: master
    autoDeploy: true

    buildCommand: |
      python -m pip install --upgrade pip setuptools wheel
      pip install --no-cache-dir -r requirements.txt

    # ⚡ Mejor entrypoint (estándar para Flask + Gunicorn)
    startCommand: |
      gunicorn wsgi:app \
        --bind 0.0.0.0:$PORT \
        --workers 2 \
        --threads 4 \
        --timeout 120 \
        --access-logfile - \
        --error-logfile - \
        --log-level info

    envVars:
      # Python runtime
      - key: PYTHON_VERSION
        value: 3.12.9

      # Flask
      - key: FLASK_ENV
        value: production

      # Seguridad
      - key: SECRET_KEY
        sync: false

      # ✅ Printful (alineado con tu código)
      - key: PRINTFUL_API_KEY
        sync: false
      - key: PRINTFUL_STORE_ID
        sync: false
      - key: PRINTFUL_CACHE_TTL
        value: "300"

      # DB (opcional)
      - key: DATABASE_URL
        sync: false

      # Mercado Pago (opcional)
      - key: MP_ACCESS_TOKEN
        sync: false
      - key: MP_PUBLIC_KEY
        sync: false
