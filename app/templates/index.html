{% extends "base.html" %}
{% block title %}Skyline Store ¬∑ Tech + Streetwear premium{% endblock %}

{% block extra_head %}
<meta name="description" content="{{ meta_description | default('Skyline Store ¬∑ Moda urbana premium, accesorios y tecnolog√≠a.') }}">
<link rel="canonical" href="{{ request.url }}">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">

<link rel="preload" as="image" href="{{ url_for('static', filename='img/banners/hero_home.png') }}">
<link rel="prefetch" href="{{ url_for('shop.shop') }}">

<style>
/* ======================================================================
   HOME ‚Äî SKYLINE PRO (FINAL)
   - NO duplica header search (home usa "hint", no buscador completo)
   - Layout marketplace real: hero + categories grid + featured + trust
   - Account: reducido a confianza, no roba ventas
   - Compat btn-* (scoped) por si hay clases viejas
====================================================================== */

.home-pro{padding:22px 0 34px}
.home-pro .sr-only{
  position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;
  overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0
}

/* Compat (solo en home): soporta tus clases previas */
.home-pro .btn-primary{ /* maps -> .btn.primary */
  color:#fff;background:linear-gradient(135deg,var(--p),var(--p2));
  border:1px solid transparent;
}
.home-pro .btn-soft{ /* maps -> .btn.ghost */
  background:rgba(255,255,255,.86);
  border:1px solid var(--border);
  color:var(--ink);
}
@media(prefers-color-scheme:dark){
  .home-pro .btn-soft{background:rgba(255,255,255,.06)}
}
.home-pro .btn-ghost{
  background:transparent;border:1px solid var(--border);color:var(--ink);
}

/* Backdrop local (m√°s pro, menos ‚Äúpastel‚Äù) */
.home-pro .hp-wrap{position:relative}
.home-pro .hp-wrap::before{
  content:"";
  position:absolute;inset:-160px -80px auto -80px;height:560px;
  background:
    radial-gradient(980px 520px at 12% 25%, rgba(37,99,235,.18), transparent 62%),
    radial-gradient(980px 520px at 88% 20%, rgba(6,182,212,.14), transparent 62%),
    radial-gradient(980px 620px at 52% 96%, rgba(245,158,11,.12), transparent 62%);
  filter: blur(10px);
  opacity:.95;
  pointer-events:none;
}

/* TOP STRIP: beneficios + quick links (sin buscador ac√°) */
.hp-top{
  display:flex;align-items:flex-start;justify-content:space-between;gap:18px;
  margin:0 0 18px;
}
.hp-badges{display:flex;gap:10px;flex-wrap:wrap}
.hp-badge{
  display:inline-flex;align-items:center;gap:10px;
  padding:9px 12px;border-radius:999px;
  background: rgba(255,255,255,.82);
  border:1px solid var(--border);
  box-shadow: var(--sh1);
  font-weight:950;letter-spacing:.12em;text-transform:uppercase;font-size:.70rem;
  color:rgba(10,16,32,.70);
  transition: transform var(--t), box-shadow var(--t), background var(--t);
}
@media(prefers-color-scheme:dark){
  .hp-badge{background: rgba(255,255,255,.06); box-shadow:none; color: rgba(238,242,255,.75)}
}
.hp-badge:hover{transform:translateY(-2px);box-shadow:var(--sh2)}
.hp-dot{
  width:9px;height:9px;border-radius:999px;
  background: linear-gradient(135deg, var(--p), var(--p2));
  box-shadow:0 12px 24px rgba(37,99,235,.22);
}
.hp-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
.hp-action{
  display:inline-flex;align-items:center;gap:10px;
  padding:10px 12px;border-radius:16px;
  background: rgba(255,255,255,.78);
  border:1px solid var(--border);
  box-shadow: var(--sh1);
  font-weight:950;color:rgba(10,16,32,.78);
  transition: transform var(--t), box-shadow var(--t), background var(--t);
}
@media(prefers-color-scheme:dark){
  .hp-action{background: rgba(255,255,255,.06); box-shadow:none; color: rgba(238,242,255,.78)}
}
.hp-action:hover{transform:translateY(-2px);box-shadow:var(--sh2);background:rgba(255,255,255,.92)}
@media(prefers-color-scheme:dark){.hp-action:hover{background:rgba(255,255,255,.08)}}
.hp-action .mini{
  width:8px;height:8px;border-radius:999px;
  background: linear-gradient(135deg, var(--acc), var(--p2));
  box-shadow:0 10px 18px rgba(245,158,11,.18);
}

/* Right hint: ‚ÄúUs√° / para buscar‚Äù (no duplica buscador) */
.hp-hint{
  border-radius: 18px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.78);
  box-shadow: var(--sh1);
  padding: 12px 14px;
  max-width: 420px;
}
@media(prefers-color-scheme:dark){
  .hp-hint{background: rgba(255,255,255,.06); box-shadow:none}
}
.hp-hint b{font-weight:1000}
.hp-hint .k{font-weight:1000;padding:2px 8px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.72)}
@media(prefers-color-scheme:dark){.hp-hint .k{background:rgba(255,255,255,.06)}}

@media(max-width:1020px){
  .hp-top{flex-direction:column;align-items:stretch}
  .hp-hint{max-width:none}
}

/* HERO: usa tu .hero global (premium) y lo potencia con layout */
.hp-hero{
  position:relative;
}
.hp-heroGrid{
  display:grid;gap:18px;
  grid-template-columns: 1fr 420px;
  align-items:stretch;
}
@media(max-width:980px){
  .hp-heroGrid{grid-template-columns:1fr}
}

/* hero content */
.hp-heroMain{
  position:relative;
  border-radius: var(--r-xl);
  overflow:hidden;
  border:1px solid var(--border);
  box-shadow: var(--sh2);
  background: rgba(255,255,255,.74);
  min-height: 460px;
  isolation:isolate;
}
@media(prefers-color-scheme:dark){
  .hp-heroMain{background: rgba(9,12,24,.62); box-shadow:none}
}
.hp-heroMedia{position:absolute;inset:0;z-index:0}
.hp-heroMedia img{
  width:100%;height:100%;object-fit:cover;
  transform: scale(1.06);
  filter: saturate(1.05) contrast(1.06) brightness(.98);
  transition: transform .9s var(--ease), filter .9s var(--ease);
}
.hp-heroShade{
  position:absolute;inset:0;z-index:1;
  background:
    radial-gradient(900px 520px at 50% 12%, rgba(255,255,255,.18), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.78));
}
@media(prefers-color-scheme:dark){
  .hp-heroShade{
    background:
      radial-gradient(900px 520px at 50% 12%, rgba(255,255,255,.06), transparent 60%),
      linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.48));
  }
}
.hp-heroInner{
  position:relative;z-index:2;
  height:100%;
  padding: clamp(18px, 2.8vw, 28px);
  display:grid;gap:14px;
  align-content:end;
}
.hp-kicker{
  display:inline-flex;align-items:center;gap:10px;
  padding:8px 12px;border-radius:999px;
  background: rgba(255,255,255,.86);
  border:1px solid rgba(10,16,32,.10);
  box-shadow: var(--sh1);
  font-weight:950;letter-spacing:.16em;text-transform:uppercase;font-size:.70rem;
  color:rgba(10,16,32,.70);
  width:fit-content;
}
@media(prefers-color-scheme:dark){
  .hp-kicker{background: rgba(255,255,255,.08); color: rgba(238,242,255,.78); box-shadow:none}
}
.hp-kicker .dot{
  width:9px;height:9px;border-radius:999px;
  background: linear-gradient(90deg, var(--good), var(--p2));
  box-shadow: 0 14px 30px rgba(22,163,74,.18);
}
.hp-title{
  margin:0;
  font-size:clamp(2.25rem, 3.6vw, 3.4rem);
  line-height:1.01;
  letter-spacing:-.048em;
  font-weight:1000;
  color: var(--ink);
  text-shadow: 0 18px 60px rgba(10,16,32,.12);
}
.hp-title .grad{
  background:linear-gradient(135deg, var(--p), var(--p2));
  -webkit-background-clip:text;background-clip:text;color:transparent;
}
.hp-sub{
  max-width:62ch;margin:0;
  font-size:1.05rem;
  color: var(--muted);
  font-weight:700;
}
.hp-ctas{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
.hp-ctas .btn{border-radius:999px;padding:12px 14px;font-weight:1000}
.hp-proof{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
.hp-pill{
  display:inline-flex;align-items:center;gap:8px;
  padding:9px 11px;border-radius:999px;
  background: rgba(255,255,255,.82);
  border:1px solid rgba(10,16,32,.10);
  box-shadow: var(--sh1);
  font-weight:950;font-size:.86rem;color:rgba(10,16,32,.74);
}
@media(prefers-color-scheme:dark){
  .hp-pill{background: rgba(255,255,255,.06); box-shadow:none; color: rgba(238,242,255,.78); border-color: rgba(148,163,184,.18)}
}
.hp-pill .p{width:8px;height:8px;border-radius:999px;background:linear-gradient(135deg,var(--p),var(--p2))}

/* Side trust panel (ANTES era ‚Äútu cuenta gigante‚Äù) */
.hp-trust{
  border-radius: var(--r-xl);
  border:1px solid var(--border);
  background: rgba(255,255,255,.82);
  box-shadow: var(--sh1);
  overflow:hidden;
}
@media(prefers-color-scheme:dark){
  .hp-trust{background: rgba(9,12,24,.62); box-shadow:none}
}
.hp-trust .inner{padding:18px}
.hp-trust .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
.hp-secure{
  display:inline-flex;align-items:center;gap:8px;
  padding:7px 10px;border-radius:999px;
  background:rgba(22,163,74,.12);
  border:1px solid rgba(22,163,74,.20);
  color:rgba(22,163,74,.95);
  font-weight:950;font-size:.78rem;
}
.hp-trust .title{font-weight:1000;font-size:1.1rem;margin:0}
.hp-trust .muted{color:var(--muted);font-weight:700;margin:6px 0 12px}
.hp-trust .ctaRow{display:flex;gap:10px;flex-wrap:wrap}
.hp-trust .ctaRow .btn{flex:1;border-radius:14px;padding:11px 12px;font-weight:1000}
.hp-trust .miniList{margin-top:14px;padding:12px;border-radius:18px;border:1px solid var(--border);background:rgba(255,255,255,.70)}
@media(prefers-color-scheme:dark){.hp-trust .miniList{background:rgba(255,255,255,.06)}}
.hp-trust .miniList b{font-weight:1000}

/* Categories grid (marketplace real) */
.hp-catsGrid{
  display:grid;gap:12px;margin-top:12px;
  grid-template-columns: repeat(2, 1fr);
}
@media(min-width:980px){
  .hp-catsGrid{grid-template-columns: repeat(4, 1fr);gap:14px}
}
.hp-cat{
  display:flex;align-items:center;gap:10px;
  padding:14px 14px;border-radius:18px;
  border:1px solid var(--border);
  background: rgba(255,255,255,.86);
  box-shadow: var(--sh1);
  transition: transform var(--t), box-shadow var(--t), border-color var(--t);
}
@media(prefers-color-scheme:dark){
  .hp-cat{background: rgba(255,255,255,.06); box-shadow:none}
}
.hp-cat:hover{transform:translateY(-4px);box-shadow:var(--sh2);border-color:rgba(37,99,235,.22)}
.hp-ico{
  width:40px;height:40px;border-radius:14px;
  background: linear-gradient(135deg, rgba(37,99,235,.14), rgba(6,182,212,.10));
  border:1px solid rgba(37,99,235,.14);
  display:grid;place-items:center;font-weight:1000;
}
.hp-cat b{font-weight:1000}
.hp-cat span{display:block;font-size:.9rem;color:var(--muted)}

/* FEATURED header */
.hp-head{
  display:flex;align-items:flex-end;justify-content:space-between;gap:14px;
  margin:24px 0 12px;
}
.hp-head .sub{color:var(--muted);font-weight:800}

/* Products grid uses your global gridP/cardP feel */
.hpGrid{margin-top:12px}

/* Product card pro */
.hpCard{
  border-radius: calc(var(--r-lg) + 2px);
  border: 1px solid rgba(10,16,32,.10);
  background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.86));
  box-shadow: var(--sh1);
  overflow:hidden;
  transition: transform var(--t), box-shadow var(--t), border-color var(--t), filter var(--t);
}
@media(prefers-color-scheme:dark){
  .hpCard{
    border-color: rgba(148,163,184,.18);
    background: linear-gradient(180deg, rgba(12,16,34,.88), rgba(12,16,34,.78));
    box-shadow:none;
  }
}
.hpCard:hover{transform:translateY(-8px);box-shadow:var(--sh2);border-color:rgba(37,99,235,.22);filter:saturate(1.05)}
.hpMedia{position:relative;aspect-ratio: 1/1;overflow:hidden;background:rgba(255,255,255,.55)}
@media(prefers-color-scheme:dark){.hpMedia{background:rgba(255,255,255,.04)}}
.hpMedia img{width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity var(--t), transform .65s var(--ease)}
.hpCard:hover .hpMedia img{transform:scale(1.08);opacity:1}
.hpChip{
  position:absolute;left:10px;top:10px;
  padding:8px 10px;border-radius:999px;
  background: rgba(255,255,255,.78);
  border:1px solid var(--border);
  font-weight:1000;font-size:.8rem;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
@media(prefers-color-scheme:dark){.hpChip{background: rgba(9,12,24,.62)}}
.hpMeta{padding:12px 12px 14px;display:grid;gap:8px}
.hpName{font-weight:1000;line-height:1.15;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.hpSub{font-size:.88rem;color:var(--muted);font-weight:700}
.hpPrice{font-weight:1000;font-size:1.08rem;color:var(--ink)}
.hpActions{display:flex;gap:10px;padding:0 12px 14px}
.hpActions .btn{flex:1;border-radius:14px;padding:11px 12px;font-weight:1000}

/* Skeletons */
.hp-skel{
  position:relative;overflow:hidden;
  border-radius: 18px;border:1px solid rgba(10,16,32,.10);
  background: rgba(255,255,255,.78);
  box-shadow: var(--sh1);
  height: 420px;
}
@media(prefers-color-scheme:dark){.hp-skel{background: rgba(255,255,255,.06); box-shadow:none}}
.hp-skel::before{
  content:"";position:absolute;inset:0;
  background: linear-gradient(90deg, rgba(255,255,255,.0), rgba(255,255,255,.55), rgba(255,255,255,.0));
  transform: translateX(-60%);
  animation: hpShimmer 1.15s infinite;
  opacity:.9;
}
@keyframes hpShimmer{to{transform: translateX(60%)}}

/* Reveal */
.hp-reveal{opacity:0;transform:translateY(10px);transition: opacity .55s var(--ease), transform .55s var(--ease)}
.hp-reveal.is-in{opacity:1;transform:translateY(0)}

/* ToTop */
.to-top{
  position:fixed;right:18px;bottom:18px;
  width:46px;height:46px;border-radius:16px;
  border:1px solid rgba(10,16,32,.12);
  background:rgba(255,255,255,.78);
  box-shadow:var(--sh2);
  cursor:pointer;display:none;font-weight:1000;
  transition: transform var(--t), box-shadow var(--t), background var(--t);
  backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
  z-index:80;
}
@media(prefers-color-scheme:dark){.to-top{background: rgba(9,12,24,.62); box-shadow:none}}
.to-top:hover{transform:translateY(-2px)}

/* Sticky CTA (mobile sales booster) */
.hpSticky{margin-top:0}

/* Focus visible (scoped) */
.home-pro a:focus-visible,
.home-pro button:focus-visible{
  outline:none;
  box-shadow: 0 0 0 7px rgba(37,99,235,.18);
  border-radius: 16px;
}

/* Reduce motion */
@media(prefers-reduced-motion:reduce){
  .hp-badge,.hp-action,.hpCard,.hp-reveal,.to-top,
  .hp-heroMedia img,.hp-skel::before{transition:none!important;animation:none!important}
}
</style>
{% endblock %}

{% block content %}
<section class="home-pro">
  <div class="hp-wrap section">

    <!-- TOP: Beneficios + Quick links + hint -->
    <section class="hp-top" aria-label="Beneficios y accesos">
      <div>
        <div class="hp-badges" aria-label="Beneficios">
          <span class="hp-badge"><span class="hp-dot"></span> Env√≠o r√°pido</span>
          <span class="hp-badge"><span class="hp-dot"></span> Pago seguro</span>
          <span class="hp-badge"><span class="hp-dot"></span> Soporte real</span>
          <span class="hp-badge"><span class="hp-dot"></span> Compra protegida</span>
        </div>

        <div class="hp-actions" aria-label="Accesos r√°pidos">
          <a class="hp-action" href="{{ url_for('shop.shop') }}?sort=new"><span class="mini"></span> Novedades</a>
          <a class="hp-action" href="{{ url_for('shop.shop') }}?q=oferta"><span class="mini"></span> Ofertas</a>
          <a class="hp-action" href="{{ url_for('shop.shop') }}"><span class="mini"></span> Ver todo</a>
        </div>
      </div>

      <div class="hp-hint" aria-label="Consejo de b√∫squeda">
        <b>Tip:</b> us√° <span class="k">/</span> para enfocarte en el buscador del header y encontrar productos en 1 segundo.
        <div style="margin-top:8px" class="small">La b√∫squeda principal est√° arriba (m√°s pro, sin duplicados).</div>
      </div>
    </section>

    <!-- HERO + TRUST -->
    <section class="hp-heroGrid" aria-label="Hero principal y confianza">

      <!-- HERO MAIN -->
      <div class="hp-heroMain hp-reveal" data-reveal>
        <div class="hp-heroMedia" aria-hidden="true">
          <img
            id="hpHeroImg"
            src="{{ url_for('static', filename='img/banners/hero_home.png') }}"
            alt=""
            loading="eager"
            decoding="async"
          >
        </div>
        <div class="hp-heroShade" aria-hidden="true"></div>

        <div class="hp-heroInner">
          <span class="hp-kicker"><span class="dot"></span> TEMPORADA 2026</span>
          <h1 class="hp-title">Streetwear <span class="grad">premium</span> + Tech</h1>
          <p class="hp-sub">Moda urbana y tecnolog√≠a seleccionada. Experiencia tipo marketplace: r√°pida, segura y con soporte real.</p>

          <div class="hp-ctas">
            <a href="{{ url_for('shop.shop') }}" class="btn primary">Comprar ahora</a>
            <a href="{{ url_for('shop.shop') }}?q=oferta" class="btn ghost">Ver ofertas</a>
            <a href="{{ url_for('shop.shop') }}?sort=new" class="btn ghost">Novedades</a>
          </div>

          <div class="hp-proof" aria-label="Confianza r√°pida">
            <span class="hp-pill"><span class="p"></span> Checkout optimizado</span>
            <span class="hp-pill"><span class="p"></span> Env√≠os r√°pidos</span>
            <span class="hp-pill"><span class="p"></span> Atenci√≥n real</span>
          </div>
        </div>
      </div>

      <!-- TRUST (antes ‚ÄúTu cuenta gigante‚Äù) -->
      <aside class="hp-trust hp-reveal" data-reveal aria-label="Seguridad y cuenta">
        <div class="inner">
          <div class="row">
            <p class="title">Compra segura</p>
            <span class="hp-secure">‚óè Verificado</span>
          </div>
          <p class="muted">Acced√© a pedidos, favoritos y cupones. Tu cuenta est√° protegida.</p>

          <div class="ctaRow">
            <a class="btn primary" href="/account">Ingresar</a>
            <a class="btn ghost" href="/account">Crear cuenta</a>
          </div>

          <div class="miniList">
            <b>Incluye</b>
            <div class="small" style="margin-top:6px">
              Seguimiento de pedidos ¬∑ cupones ¬∑ drops exclusivos ¬∑ soporte
            </div>
          </div>

          <hr>

          <div class="small">
            <b>Pago:</b> MercadoPago / Transferencia / (pr√≥ximamente m√°s) <br>
            <b>Env√≠os:</b> r√°pidos y con seguimiento
          </div>
        </div>
      </aside>

    </section>

    <!-- CATEGORIES GRID (marketplace) -->
    <section aria-label="Categor√≠as" style="margin-top:16px">
      <div class="hp-head">
        <div>
          <h2 class="hp-reveal" data-reveal>Categor√≠as</h2>
          <div class="sub hp-reveal" data-reveal>Encontr√° r√°pido lo que busc√°s</div>
        </div>
        <a class="btn ghost hp-reveal" data-reveal href="{{ url_for('shop.shop') }}">Ver todo ‚Üí</a>
      </div>

      <div class="hp-catsGrid">
        <a class="hp-cat hp-reveal" data-reveal href="{{ url_for('shop.shop') }}?categoria=ropa">
          <span class="hp-ico">üëï</span>
          <div><b>Ropa urbana</b><span>Lo m√°s vendido</span></div>
        </a>
        <a class="hp-cat hp-reveal" data-reveal href="{{ url_for('shop.shop') }}?categoria=accesorios">
          <span class="hp-ico">üß¢</span>
          <div><b>Accesorios</b><span>Street essentials</span></div>
        </a>
        <a class="hp-cat hp-reveal" data-reveal href="{{ url_for('shop.shop') }}?categoria=tecnologia">
          <span class="hp-ico">‚åö</span>
          <div><b>Tecnolog√≠a</b><span>Gadgets premium</span></div>
        </a>
        <a class="hp-cat hp-reveal" data-reveal href="{{ url_for('shop.shop') }}?q=oferta">
          <span class="hp-ico">üî•</span>
          <div><b>Ofertas</b><span>Descuentos reales</span></div>
        </a>
      </div>
    </section>

    <!-- FEATURED PRODUCTS -->
    <section class="hpGrid" aria-label="Productos destacados">
      <div class="hp-head">
        <div>
          <h2 class="hp-reveal" data-reveal>Destacados</h2>
          <div class="sub hp-reveal" data-reveal>Selecci√≥n premium curada para vos</div>
        </div>
        <a class="btn ghost hp-reveal" data-reveal href="{{ url_for('shop.shop') }}">Ver todo ‚Üí</a>
      </div>

      {% set featured_list = featured if featured is defined else [] %}

      <div class="gridP" id="hpGrid">
        {% if featured_list|length == 0 %}
          <div class="hp-skel"></div>
          <div class="hp-skel"></div>
          <div class="hp-skel"></div>
          <div class="hp-skel"></div>

          <div class="card" style="grid-column:1 / -1; padding:18px">
            <h3 style="margin:0 0 6px">Todav√≠a no hay productos destacados</h3>
            <p style="margin:0">Cargalos desde Admin ‚Üí Productos y van a aparecer ac√° autom√°ticamente.</p>
            <div style="margin-top:12px">
              <a class="btn primary" href="{{ url_for('shop.shop') }}">Ir a la tienda</a>
            </div>
          </div>
        {% else %}
          {% for p in featured_list %}
            <article class="hpCard hp-reveal" data-reveal aria-label="Producto destacado">
              <div class="hpMedia">
                <span class="hpChip">Destacado</span>
                <img src="{{ p.img }}" alt="{{ p.title }}" loading="lazy" decoding="async" onload="this.style.opacity=1">
              </div>

              <div class="hpMeta">
                <div class="hpName">{{ p.title }}</div>
                <div class="hpSub">Selecci√≥n premium</div>
                <div class="hpPrice">{{ p.price }}</div>
              </div>

              <div class="hpActions">
                <a class="btn primary" href="{{ p.href }}">Comprar</a>
                <a class="btn ghost" href="{{ p.href }}">Detalles</a>
              </div>
            </article>
          {% endfor %}
        {% endif %}
      </div>
    </section>

  </div>
</section>

<!-- Sticky CTA (mobile) -->
<div class="sticky-cta" id="hpSticky">
  <div class="inner">
    <div>
      <b>Skyline Store</b>
      <p class="small">Explor√° ofertas y drops premium</p>
    </div>
    <a class="cta-btn" href="{{ url_for('shop.shop') }}">Comprar</a>
  </div>
</div>

<button class="to-top" id="toTop" aria-label="Volver arriba">‚Üë</button>

<script>
(() => {
  const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  // Reveal
  const items = [...document.querySelectorAll('[data-reveal]')];
  if (!reduce && 'IntersectionObserver' in window && items.length) {
    const io = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          e.target.classList.add('is-in');
          io.unobserve(e.target);
        }
      });
    }, { threshold: 0.10, rootMargin: '0px 0px -8% 0px' });
    items.forEach(el => io.observe(el));
  } else {
    items.forEach(el => el.classList.add('is-in'));
  }

  // ToTop
  const btn = document.getElementById("toTop");
  const sticky = document.getElementById("hpSticky");
  const onScroll = () => {
    const y = window.scrollY || 0;
    if (btn) btn.style.display = (y > 520) ? "inline-flex" : "none";
    // Sticky CTA: aparece luego del hero (mejora conversi√≥n mobile)
    if (sticky) sticky.classList.toggle("is-on", y > 420);
  };
  window.addEventListener("scroll", onScroll, { passive: true });
  onScroll();
  btn && btn.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));

  // Shortcut "/" para enfocar el buscador del HEADER (global)
  document.addEventListener('keydown', (e) => {
    if (e.key !== '/' || e.ctrlKey || e.metaKey || e.altKey) return;
    const tag = (document.activeElement && document.activeElement.tagName) || '';
    if (tag === 'INPUT' || tag === 'TEXTAREA') return;

    // intenta encontrar el input del topbar (ajust√° selector si tu header usa otro)
    const topSearch = document.querySelector('.topbar input[name="q"], .topbar input[type="search"], .topbar input');
    if (topSearch) {
      e.preventDefault();
      topSearch.focus({ preventScroll: true });
    }
  });

  // Parallax sutil hero
  const hero = document.querySelector('.hp-heroMain');
  const heroImg = document.getElementById('hpHeroImg');
  if (!reduce && hero && heroImg) {
    let rx = 0, ry = 0, sx = 0, sy = 0;
    const tick = () => {
      sx += (rx - sx) * 0.08;
      sy += (ry - sy) * 0.08;
      heroImg.style.transform = `scale(1.06) translate3d(${sx}px, ${sy}px, 0)`;
      requestAnimationFrame(tick);
    };
    requestAnimationFrame(tick);

    hero.addEventListener('mousemove', (e) => {
      const r = hero.getBoundingClientRect();
      const px = (e.clientX - r.left) / r.width - 0.5;
      const py = (e.clientY - r.top) / r.height - 0.5;
      rx = px * 10;
      ry = py * 8;
    });
    hero.addEventListener('mouseleave', () => { rx = 0; ry = 0; });
  }
})();
</script>
{% endblock %}
