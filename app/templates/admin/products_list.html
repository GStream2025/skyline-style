{# app/templates/admin/products_list.html — Listado PRO #}
{% extends "admin/base_admin.html" %}
{% block title %}Productos · Admin{% endblock %}

{% block content %}
  <h1 style="margin:.2rem 0 0;font-weight:1000;letter-spacing:-.5px">Productos</h1>
  <p class="muted" style="margin:.45rem 0 1rem">
    Buscar, editar, publicar. Preparado para escalar.
  </p>

  <form method="get" style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px">
    <input name="q" value="{{ q }}" placeholder="Buscar por título..." style="flex:1;min-width:220px">
    <button class="btn" type="submit">Buscar</button>
    <a class="btn2" href="{{ url_for('admin.products_list') }}">Reset</a>
    <a class="btn2" href="{{ url_for('admin.products_new') }}">Nuevo</a>
  </form>

  {% if products and products|length %}
    <table>
      <thead>
        <tr>
          <th style="width:70px">ID</th>
          <th>Título</th>
          <th style="width:120px">Precio</th>
          <th style="width:120px">Stock</th>
          <th style="width:120px">Estado</th>
          <th style="width:240px">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for p in products %}
          <tr>
            <td>{{ p.id }}</td>
            <td>
              <div style="font-weight:950">{{ p.title if p.title is defined else p.name }}</div>
              <div class="muted" style="font-size:.92rem">
                {% if p.slug is defined %}slug: {{ p.slug }} · {% endif %}
                {% if p.source is defined %}source: {{ p.source }}{% endif %}
              </div>
            </td>
            <td>{{ p.price if p.price is defined else '' }}</td>
            <td>{{ p.stock if p.stock is defined else '' }}</td>
            <td>{{ p.status if p.status is defined else '' }}</td>
            <td style="display:flex;gap:10px;flex-wrap:wrap">
              <a class="btn2" href="{{ url_for('admin.products_edit', product_id=p.id) }}">Editar</a>
              <form method="post" action="{{ url_for('admin.products_delete', product_id=p.id) }}" onsubmit="return confirm('Eliminar producto?')" style="margin:0">
                <button class="btn2" type="submit">Eliminar</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="msg info">No hay productos todavía. Creá el primero ✅</div>
  {% endif %}
{% endblock %}
