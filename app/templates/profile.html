{% extends "base.html" %}
{% block title %}Mi cuenta ¬∑ Skyline Store{% endblock %}

{% block extra_head %}
<style>
  :root{
    --bg:#f6f7fb;
    --card:#ffffff;
    --ink:#0b1220;
    --muted: rgba(11,18,32,.68);
    --muted2: rgba(11,18,32,.52);
    --stroke: rgba(15,23,42,.10);
    --shadow1: 0 10px 26px rgba(2,6,23,.08);
    --shadow2: 0 18px 55px rgba(2,6,23,.10);
    --a:#2563eb;
    --b:#06b6d4;
    --c:#f59e0b;
    --g:#22c55e;
    --r: 14px;
    --r2: 18px;
    --ease: cubic-bezier(.2,.9,.2,1);
  }

  .page{
    background: linear-gradient(180deg,#fff,var(--bg));
    padding: 18px 0 34px;
  }
  .wrap{max-width:1220px;margin:0 auto;padding:0 18px}

  .grid{
    display:grid;
    gap:12px;
  }

  /* Header premium */
  .hero{
    position:relative;
    border-radius: var(--r2);
    overflow:hidden;
    background: linear-gradient(135deg,
      rgba(37,99,235,.12),
      rgba(6,182,212,.10),
      rgba(245,158,11,.08));
    border:1px solid rgba(15,23,42,.10);
    box-shadow: var(--shadow2);
  }
  .hero::before{
    content:"";
    position:absolute; inset:-30%;
    background:
      radial-gradient(circle at 25% 25%, rgba(37,99,235,.20), transparent 55%),
      radial-gradient(circle at 78% 30%, rgba(245,158,11,.16), transparent 55%),
      radial-gradient(circle at 35% 82%, rgba(34,197,94,.12), transparent 55%);
    filter: blur(18px);
    opacity:.9;
  }
  .hero-inner{
    position:relative;
    padding: 18px;
    display:grid;
    gap:12px;
  }
  @media(min-width:900px){
    .hero-inner{
      grid-template-columns: 1.2fr .8fr;
      align-items:end;
      padding: 20px;
    }
  }

  .badge{
    display:inline-flex;align-items:center;gap:8px;
    padding: 8px 12px;
    border-radius: 999px;
    background: rgba(255,255,255,.82);
    border:1px solid rgba(15,23,42,.10);
    box-shadow: var(--shadow1);
    font-weight:1000;
    font-size:.75rem;
    letter-spacing:.12em;
    text-transform:uppercase;
    color: rgba(11,18,32,.78);
    width: fit-content;
  }
  .dot{
    width:8px;height:8px;border-radius:999px;
    background: linear-gradient(90deg,var(--g),var(--b));
    box-shadow: 0 0 0 0 rgba(34,197,94,.0);
  }

  .title{
    margin: 8px 0 0;
    font-weight:1000;
    letter-spacing:-.8px;
    color: var(--ink);
    font-size: clamp(1.6rem, 3.2vw, 2.2rem);
    line-height:1.1;
  }
  .sub{
    margin: 8px 0 0;
    color: var(--muted);
    font-weight: 850;
    line-height:1.55;
    max-width: 60ch;
  }

  .chips{
    display:flex;flex-wrap:wrap;gap:8px;
    margin-top: 10px;
  }
  .chip{
    padding: 8px 10px;
    border-radius: 999px;
    background: rgba(255,255,255,.82);
    border:1px solid rgba(15,23,42,.10);
    font-weight: 950;
    font-size: .78rem;
    color: rgba(11,18,32,.78);
  }

  .card{
    background: rgba(255,255,255,.92);
    border:1px solid rgba(15,23,42,.10);
    border-radius: var(--r2);
    box-shadow: var(--shadow1);
    overflow:hidden;
  }
  .card-pad{padding:14px}

  .points{
    display:grid;gap:10px;
  }
  .points h3{
    margin:0;
    font-weight:1000;
    letter-spacing:-.4px;
    color: var(--ink);
  }
  .big{
    font-size: 2rem;
    font-weight: 1000;
    letter-spacing:-.6px;
    color: var(--ink);
    margin:0;
  }
  .big span{font-size:.9rem;color:var(--muted);font-weight:900}

  .bar{
    height:10px;
    background: rgba(15,23,42,.08);
    border-radius: 999px;
    overflow:hidden;
  }
  .bar > i{
    display:block;height:100%;
    width:0%;
    background: linear-gradient(90deg, var(--a), var(--b), var(--g));
  }
  .hint{
    margin:0;
    color: var(--muted2);
    font-weight: 850;
    font-size: .9rem;
    line-height:1.45;
  }

  /* Buttons */
  .btnrow{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
  .btn{
    display:inline-flex;align-items:center;justify-content:center;gap:8px;
    padding: 11px 14px;
    border-radius: 12px;
    font-weight: 1000;
    text-decoration:none;
    border:1px solid transparent;
    transition: transform .2s var(--ease), box-shadow .2s var(--ease), filter .2s var(--ease);
    user-select:none;
  }
  .btn:hover{transform: translateY(-2px); filter:saturate(1.06)}
  .btn:active{transform: translateY(-1px)}
  .btn-primary{
    background: linear-gradient(135deg, var(--a), var(--b));
    color:#fff;
    box-shadow: var(--shadow2);
  }
  .btn-soft{
    background: rgba(255,255,255,.86);
    border-color: rgba(15,23,42,.12);
    color: var(--ink);
    box-shadow: var(--shadow1);
  }
  .btn-warn{
    background: rgba(245,158,11,.14);
    border-color: rgba(245,158,11,.28);
    color: rgba(11,18,32,.92);
    box-shadow: var(--shadow1);
  }

  /* Metrics */
  .metrics{
    display:grid;gap:12px;
    grid-template-columns: 1fr;
  }
  @media(min-width:900px){
    .metrics{grid-template-columns: repeat(4, 1fr)}
  }
  .metric{
    padding:14px;
    border-radius: var(--r2);
    background:#fff;
    border:1px solid rgba(15,23,42,.10);
    box-shadow: var(--shadow1);
    transition: transform .2s var(--ease), box-shadow .2s var(--ease);
  }
  .metric:hover{transform: translateY(-3px); box-shadow: var(--shadow2)}
  .metric .k{color:var(--muted2);font-weight:1000;font-size:.78rem;letter-spacing:.12em;text-transform:uppercase}
  .metric .v{margin:6px 0 0;font-weight:1000;font-size:1.55rem;color:var(--ink);letter-spacing:-.4px}
  .metric .d{margin:4px 0 0;color:var(--muted);font-weight:850;font-size:.9rem;line-height:1.35}

  /* Actions + Orders */
  .two{
    display:grid;gap:12px;
    grid-template-columns:1fr;
  }
  @media(min-width:900px){
    .two{grid-template-columns: 1fr 1fr}
  }

  .list{
    display:grid;
    gap:10px;
  }
  .row{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:12px;
    padding:12px;
    border-radius: 14px;
    background: rgba(15,23,42,.03);
    border:1px solid rgba(15,23,42,.08);
  }
  .row b{display:block;font-weight:1000;color:var(--ink)}
  .row span{display:block;margin-top:2px;color:var(--muted);font-weight:850;font-size:.9rem}
  .pill{
    padding:6px 10px;
    border-radius:999px;
    font-weight:1000;
    font-size:.78rem;
    border:1px solid rgba(15,23,42,.12);
    background:#fff;
    color: rgba(11,18,32,.80);
    white-space:nowrap;
  }
  .pill.ok{border-color: rgba(34,197,94,.26); background: rgba(34,197,94,.10)}
  .pill.wait{border-color: rgba(245,158,11,.26); background: rgba(245,158,11,.10)}
  .pill.off{border-color: rgba(37,99,235,.20); background: rgba(37,99,235,.10)}

  .notice{
    border-radius: 14px;
    padding: 12px 14px;
    border:1px solid rgba(245,158,11,.30);
    background: rgba(245,158,11,.12);
    color: rgba(11,18,32,.86);
    font-weight: 900;
    font-size: .9rem;
    line-height:1.4;
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce){
    *{transition:none!important}
    .metric:hover,.btn:hover{transform:none!important}
  }
</style>
{% endblock %}

{% block content %}
{% set name = user_name|default('Skyline Guest') %}
{% set last = last_login|default('hace poco') %}

{% set orders = orders_count|default(0) %}
{% set favs = favorites_count|default(0) %}
{% set points = skyline_points|default(0) %}
{% set next_pts = next_level_points|default(500) %}
{% set pct = ((points / next_pts) * 100) if next_pts else 0 %}
{% if pct > 100 %}{% set pct = 100 %}{% endif %}

<div class="page">
  <div class="wrap grid" style="gap:14px">

    <!-- HEADER -->
    <header class="hero" aria-label="Panel de usuario">
      <div class="hero-inner">
        <div>
          <div class="badge">
            <span class="dot" aria-hidden="true"></span>
            MI CUENTA ¬∑ SKYLINE STORE
          </div>

          <h1 class="title">Hola, {{ name }}</h1>
          <p class="sub">
            Este es tu panel personal. Ac√° vas a ver tus pedidos, favoritos, puntos y accesos r√°pidos.
            Todo listo para conectarlo al backend real.
          </p>

          <div class="chips" aria-label="Informaci√≥n r√°pida">
            <span class="chip">√öltimo acceso: <b style="color:rgba(11,18,32,.86)">{{ last }}</b></span>
            <span class="chip">Nivel: <b style="color:#f59e0b">Standard</b></span>
            <span class="chip">Estado: <b style="color:#22c55e">Activo</b></span>
          </div>

          <div class="btnrow">
            <a class="btn btn-primary" href="/shop" aria-label="Ir a la tienda">üõí Ir a la tienda</a>
            <a class="btn btn-soft" href="/#destacados" aria-label="Ver destacados">üî• Ver destacados</a>
            <a class="btn btn-warn" href="/shop?ofertas=1" aria-label="Ver ofertas">‚ö° Ver ofertas</a>
          </div>
        </div>

        <!-- PUNTOS -->
        <aside class="card card-pad points" aria-label="Puntos Skyline">
          <div style="display:flex;align-items:flex-end;justify-content:space-between;gap:10px">
            <div>
              <p style="margin:0;color:var(--muted2);font-weight:950;letter-spacing:.12em;text-transform:uppercase;font-size:.78rem">
                Puntos Skyline
              </p>
              <p class="big">{{ points }} <span>pts</span></p>
            </div>
            <span class="pill off" title="Pr√≥ximo nivel">Pr√≥ximo: {{ next_pts }}</span>
          </div>

          <div class="bar" role="progressbar" aria-valuenow="{{ pct|round(0) }}" aria-valuemin="0" aria-valuemax="100">
            <i style="width: {{ pct|round(0) }}%;"></i>
          </div>

          <p class="hint">
            {{ points }} / {{ next_pts }} pts para el pr√≥ximo nivel.
            Cuanto m√°s compr√°s, m√°s beneficios desbloque√°s.
          </p>
        </aside>
      </div>
    </header>

    <!-- M√âTRICAS -->
    <section class="metrics" aria-label="M√©tricas de cuenta">
      <article class="metric">
        <div class="k">Pedidos</div>
        <div class="v">{{ orders }}</div>
        <div class="d">Historial de compras y env√≠os</div>
      </article>
      <article class="metric">
        <div class="k">Favoritos</div>
        <div class="v">{{ favs }}</div>
        <div class="d">Productos guardados</div>
      </article>
      <article class="metric">
        <div class="k">Puntos</div>
        <div class="v">{{ points }}</div>
        <div class="d">Beneficios acumulados</div>
      </article>
      <article class="metric">
        <div class="k">Nivel</div>
        <div class="v" style="color:#f59e0b;font-size:1.25rem;margin-top:10px">Standard</div>
        <div class="d">Drops, cupones y perks</div>
      </article>
    </section>

    <!-- ACCIONES + √öLTIMOS PEDIDOS (DEMO) -->
    <section class="two" aria-label="Acciones y pedidos">
      <div class="card card-pad">
        <h2 style="margin:0;font-weight:1000;letter-spacing:-.5px">Acciones r√°pidas</h2>
        <p style="margin:6px 0 0;color:var(--muted);font-weight:850;line-height:1.5">
          Entr√° directo a lo que te interesa.
        </p>

        <div class="list" style="margin-top:12px">
          <a class="row" href="/shop" style="text-decoration:none">
            <div>
              <b>üõí Comprar ahora</b>
              <span>Explor√° la colecci√≥n completa</span>
            </div>
            <span class="pill ok">Ir</span>
          </a>

          <a class="row" href="/shop?ofertas=1" style="text-decoration:none">
            <div>
              <b>‚ö° Ofertas</b>
              <span>Promos semanales y descuentos</span>
            </div>
            <span class="pill wait">Ver</span>
          </a>

          <a class="row" href="/#destacados" style="text-decoration:none">
            <div>
              <b>üî• Destacados</b>
              <span>Drops y recomendaciones</span>
            </div>
            <span class="pill off">Abrir</span>
          </a>
        </div>
      </div>

      <div class="card card-pad">
        <h2 style="margin:0;font-weight:1000;letter-spacing:-.5px">√öltimos pedidos (demo)</h2>
        <p style="margin:6px 0 0;color:var(--muted);font-weight:850;line-height:1.5">
          Esto est√° listo para conectarse a tu backend real cuando tengas tabla de pedidos.
        </p>

        {% set demo_orders = demo_orders if demo_orders is defined else [
          {"id":"SKY-1041","status":"En camino","cls":"ok","meta":"Montevideo ¬∑ 24/48hs"},
          {"id":"SKY-1029","status":"Procesando","cls":"wait","meta":"Pago confirmado"},
          {"id":"SKY-1014","status":"Entregado","cls":"off","meta":"Gracias por tu compra"}
        ] %}

        <div class="list" style="margin-top:12px">
          {% for o in demo_orders %}
          <div class="row">
            <div>
              <b>Pedido {{ o.id }}</b>
              <span>{{ o.meta }}</span>
            </div>
            <span class="pill {{ o.cls }}">{{ o.status }}</span>
          </div>
          {% endfor %}
        </div>

        <div class="notice" style="margin-top:12px">
          ‚ö†Ô∏è Modo demo activo. Cuando conectes pedidos reales, esto se llena solo.
        </div>
      </div>
    </section>

  </div>
</div>
{% endblock %}
