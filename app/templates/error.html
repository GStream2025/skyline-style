{% extends "base.html" %}

{% block title %}404 — Página no encontrada | Skyline Store{% endblock %}

{% block extra_head %}
  {# ✅ Mejora: robots noindex para errores #}
  <meta name="robots" content="noindex,nofollow">
{% endblock %}

{% block content %}
<section class="container" aria-labelledby="err-title" style="padding-top:28px;padding-bottom:44px;">
  <div class="card" role="region" aria-label="Error 404" style="max-width:920px;margin:0 auto;padding:26px;">
    {# ===== Header ===== #}
    <div class="grid" style="gap:14px;">
      <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;justify-content:space-between;">
        <div style="display:flex;align-items:center;gap:10px;">
          <span class="brand-dot" aria-hidden="true"></span>
          <div>
            <div class="small" style="letter-spacing:.18em;text-transform:uppercase;font-weight:800;color:var(--muted);">
              Skyline Store
            </div>
            <h1 id="err-title" style="margin-top:2px;">
              Ups… esta página no existe
            </h1>
          </div>
        </div>

        {# ✅ Mejora: status pill #}
        <span class="badge warn" aria-label="Estado">
          404 • No encontrado
        </span>
      </div>

      <p class="small" style="max-width:70ch;">
        Puede que el enlace esté mal, que el producto ya no esté disponible o que la página se haya movido.
        Probá volver a la tienda o usar el buscador.
      </p>
    </div>

    {# ===== Big code + decorative ===== #}
    <div class="grid grid-2" style="margin-top:18px;align-items:stretch;">
      <div class="card" style="box-shadow:none;border:1px solid var(--border);background:rgba(255,255,255,.7);">
        <div style="display:flex;align-items:flex-end;gap:10px;justify-content:center;padding:10px 6px;">
          <span style="font-size:64px;font-weight:950;line-height:1;color:rgba(11,18,32,.15);">4</span>
          <span style="font-size:64px;font-weight:950;line-height:1;
                       background:linear-gradient(135deg,var(--primary),var(--primary-2));
                       -webkit-background-clip:text;background-clip:text;color:transparent;">
            0
          </span>
          <span style="font-size:64px;font-weight:950;line-height:1;color:rgba(11,18,32,.15);">4</span>
        </div>

        {# ✅ Mejora: hint #}
        <div class="small" style="text-align:center;margin-top:2px;">
          Error de navegación • Código: <b>SS-404</b>
        </div>

        {# ✅ Mejora: acciones recomendadas #}
        <div style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:14px;">
          <a class="btn btn-primary" href="{{ url_for('main.index') }}" aria-label="Volver al inicio">
            Volver al inicio
          </a>
          <a class="btn" href="{{ url_for('main.shop') }}" aria-label="Ir a la tienda">
            Ir a la tienda
          </a>
          <button class="btn btn-ghost" type="button" id="btnBack" aria-label="Volver atrás">
            Volver atrás
          </button>
        </div>
      </div>

      {# ===== Quick search + suggestions ===== #}
      <div class="card" style="box-shadow:none;border:1px solid var(--border);background:rgba(255,255,255,.7);">
        <h2 style="margin-bottom:6px;">Encontrá lo que buscabas</h2>
        <p class="small" style="margin-top:0;">
          Usá el buscador para productos, categorías o marcas. Te llevamos directo.
        </p>

        {# ✅ Mejora: mini search form (no rompe si shop usa q) #}
        <form class="grid" action="{{ url_for('main.shop') }}" method="get" role="search" aria-label="Buscar en la tienda" style="gap:10px;margin-top:10px;">
          <div class="field">
            <label for="q">Buscar</label>
            <input id="q" name="q" type="search" inputmode="search"
                   placeholder="Ej: buzo, gorro, auriculares..."
                   autocomplete="off"
                   value="{{ request.args.get('q','') }}">
          </div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;">
            <button class="btn btn-primary" type="submit">Buscar ahora</button>
            <a class="btn" href="{{ url_for('main.shop') }}">Ver todo</a>
          </div>
        </form>

        {# ✅ Mejora: atajos rápidos (solo links) #}
        <div style="margin-top:14px;">
          <div class="small" style="font-weight:800;color:var(--muted);margin-bottom:8px;">Atajos rápidos</div>
          <div style="display:flex;flex-wrap:wrap;gap:8px;">
            <a class="btn" href="{{ url_for('main.shop') }}?categoria=ropa">Ropa</a>
            <a class="btn" href="{{ url_for('main.shop') }}?categoria=accesorios">Accesorios</a>
            <a class="btn" href="{{ url_for('main.shop') }}?categoria=tecnologia">Tecnología</a>
            <a class="btn" href="{{ url_for('main.shop') }}?ofertas=1">Ofertas</a>
          </div>
        </div>

        {# ✅ Mejora: soporte rápido #}
        <div class="empty" style="margin-top:16px;padding:16px;">
          <div style="font-weight:900;">¿Seguís con el problema?</div>
          <div class="small" style="margin-top:4px;">
            Si llegaste desde un enlace roto, avisame y lo arreglamos.
          </div>
          <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:10px;">
            <a class="btn" href="{{ url_for('main.index') }}#contacto">Contactar soporte</a>
            <a class="btn btn-ghost" href="{{ url_for('main.shop') }}">Seguir comprando</a>
          </div>
        </div>
      </div>
    </div>

    {# ✅ Mejora: detalles técnicos discretos (solo si DEBUG=1) #}
    {% if config.DEBUG %}
      <div class="card" style="margin-top:16px;box-shadow:none;border:1px solid rgba(220,38,38,.18);background:rgba(220,38,38,.06);">
        <div style="font-weight:900;color:rgba(220,38,38,.92);">Debug</div>
        <div class="small" style="margin-top:6px;">
          Path: <code style="font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;">
            {{ request.path }}
          </code>
        </div>
      </div>
    {% endif %}
  </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
  // ✅ Mejora: "volver atrás" elegante y seguro
  (function(){
    const btn = document.getElementById('btnBack');
    if(!btn) return;
    btn.addEventListener('click', function(){
      if (history.length > 1) history.back();
      else window.location.href = "{{ url_for('main.index') }}";
    });
  })();

  // ✅ Mejora: autofocus buscador en desktop (sin molestar mobile)
  (function(){
    const q = document.getElementById('q');
    if(!q) return;
    const isSmall = window.matchMedia && window.matchMedia("(max-width: 560px)").matches;
    if(!isSmall) { try { q.focus(); } catch(e){} }
  })();
</script>
{% endblock %}
