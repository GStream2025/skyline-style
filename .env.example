# ======================================================
# SKYLINE STORE — .env.example (ULTRA PRO / FINAL / NO BREAK) v3 ✅ +10 mejoras
# ======================================================
# ✅ Este archivo SÍ se sube a Git como referencia exacta (1:1) de variables
# ✅ Producción (Render): setear valores reales en Dashboard
# ❌ NO pegues secretos reales acá (tokens, passwords, API keys)
#
# Garantías:
# - No rompe si una feature está apagada
# - No crea admins por accidente (SEED=0 + SKIP_ADMIN_BOOTSTRAP=1)
# - Compatible con create_app() + auto-register de routes
# ======================================================


# ------------------------------------------------------
# 1) APP / FLASK
# ------------------------------------------------------
ENV=production
FLASK_ENV=production
DEBUG=0
LOG_LEVEL=INFO

HOST=0.0.0.0
PORT=10000

APP_NAME=Skyline Store
APP_URL=https://your-domain.example
PUBLIC_BASE_URL=https://your-domain.example
PREFERRED_URL_SCHEME=https
FORCE_HTTPS=1

TZ=America/Montevideo
APP_CONFIG_VERSION=3
SHOW_TRACEBACKS=0

PYTHONIOENCODING=utf-8
PYTHONUTF8=1

# ✅ Mejora 1: evita canonical redirect mal si APP_URL queda vacío
CANONICAL_HOST_ENFORCE=1

# ✅ Mejora 2: name de app para mails/branding (si tu mailer lo usa)
EMAIL_BRAND_NAME=Skyline Store


# ------------------------------------------------------
# 2) SEGURIDAD / SESIONES (HARDENED)
# ------------------------------------------------------
# ✅ Prod: EXIGE SECRET_KEY real (>=32). Ejemplo NO válido.
SECRET_KEY=CHANGE_ME_SET_REAL_SECRET_32+CHARS
SETTINGS_MASTER_KEY=CHANGE_ME_MASTER_KEY_32+CHARS
REQUIRE_SETTINGS_MASTER_KEY=1

# Session / cookies
SESSION_PERMANENT=1
SESSION_PERMANENT_DAYS=30
PERMANENT_SESSION_LIFETIME_SEC=2592000

SESSION_COOKIE_NAME=skyline_session
SESSION_COOKIE_HTTPONLY=1
SESSION_COOKIE_SECURE=1
SESSION_COOKIE_SAMESITE=Lax
SESSION_COOKIE_PATH=/
SESSION_COOKIE_DOMAIN=

COOKIE_SECURE=1
TRUST_PROXY_HEADERS=1

# Cache-control para admin/auth (si tu app lo respeta)
ADMIN_NO_CACHE=1

# ✅ Mejora 3: CSP/Talisman friendly toggle (si tu app lo usa)
SECURITY_HEADERS_ENABLED=1


# ------------------------------------------------------
# 3) CSRF (compat Flask-WTF + custom)
# ------------------------------------------------------
REQUIRE_CSRF=1
CSRF_HEADER=X-CSRF-Token

WTF_CSRF_TIME_LIMIT=3600
WTF_CSRF_SSL_STRICT=1
WTF_CSRF_SECRET_KEY=CHANGE_ME_CSRF_SECRET_32+CHARS

# ✅ Mejora 4: misma clave usada por tus templates/meta si aplica
WTF_CSRF_ENABLED=1


# ------------------------------------------------------
# 4) AUTH HARDENING / LIMITS
# ------------------------------------------------------
# ✅ Unificamos flags para evitar confusión (tu app puede leer cualquiera)
VERIFY_EMAIL_ENABLED=0
VERIFY_EMAIL_REQUIRED=0
VERIFY_TOKEN_MAX_AGE_SEC=86400
RESEND_VERIFY_COOLDOWN_SEC=60
VERIFY_EMAIL_PATH=/auth/verify-email

AUTO_LOGIN_AFTER_REGISTER=1
ACCOUNT_ALLOW_JSON=1

AUTH_MIN_PASSWORD_LEN=8
AUTH_FORM_NONCE_TTL=1200

AUTH_RATE_LIMIT_SECONDS=2
AUTH_RATE_LIMIT_BURST=6
AUTH_RATE_LIMIT_WINDOW=60

AUTH_MAX_LOGIN_ATTEMPTS=8
AUTH_LOCK_MINUTES=15

ALLOW_ADMIN_SELF_REGISTER=0

# ✅ Mejora 5: switch de diagnóstico sin debug (útil en Render)
CONFIG_DIAGNOSTICS=1


# ------------------------------------------------------
# 5) DATABASE / SQLALCHEMY
# ------------------------------------------------------
DATABASE_URL=
SQLALCHEMY_DATABASE_URI=

SQLALCHEMY_TRACK_MODIFICATIONS=0
SQLALCHEMY_POOL_PRE_PING=1
DB_POOL_RECYCLE=280

# sqlite dev only
SQLITE_BUSY_TIMEOUT_MS=5000

# create_all solo dev
AUTO_CREATE_TABLES=0

# ✅ Mejora 6: health checks para Render
HEALTH_DB_CHECK=1
HEALTH_MODE=basic


# ------------------------------------------------------
# 6) UPLOADS / ARCHIVOS
# ------------------------------------------------------
UPLOADS_DIR=static/uploads
MAX_UPLOAD_MB=20
MAX_CONTENT_LENGTH_MB=20

UPLOAD_ALLOWED_EXT=jpg,jpeg,png,webp,gif,pdf
UPLOAD_MAX_FILENAME_LEN=120
UPLOAD_MAX_FILES=8
IMAGE_THUMB_SIZES=320,640,960

# ✅ Mejora 7: hard limit bytes (si tu app lo soporta)
MAX_BODY_BYTES=200000


# ------------------------------------------------------
# 7) OWNER / ADMIN (CONTROL TOTAL)
# ------------------------------------------------------
# CRÍTICO: apagado en example
SEED=0
SKIP_ADMIN_BOOTSTRAP=1

ADMIN_EMAIL=
ADMIN_PASSWORD=
ADMIN_NAME=
ADMIN_ROLE=admin
OWNER_EMAIL=

# ✅ Mejora 8: owner hardening (si tu User lo usa)
OWNER_FORCE_VERIFY=1


# ------------------------------------------------------
# 8) FEATURES (NO BREAK)
# ------------------------------------------------------
ENABLE_PRINTFUL=0
ENABLE_PAYMENTS=0
ENABLE_EMAILS=0

PAYMENTS_MODE=sandbox
CURRENCY_DEFAULT=UYU
COUNTRY_DEFAULT=UY

ENABLE_HOME_CACHE=1
HOME_CACHE_TTL=120
HOME_CACHE_TTL_SECONDS=120

# ✅ Mejora 9: rate limits de módulos (si existen)
ADMIN_RATE_SECONDS=2
ACCOUNT_RATE_LIMIT_SECONDS=2


# ------------------------------------------------------
# 9) PRINTFUL
# ------------------------------------------------------
PRINTFUL_API_KEY=
PRINTFUL_STORE_ID=
PRINTFUL_BASE_URL=https://api.printful.com
PRINTFUL_CACHE_TTL=300


# ------------------------------------------------------
# 10) PAGOS — MERCADOPAGO / OTROS
# ------------------------------------------------------
MP_PUBLIC_KEY=
MP_ACCESS_TOKEN=
MP_WEBHOOK_SECRET=

PAYPAL_CLIENT_ID=
PAYPAL_CLIENT_SECRET=
PAYPAL_WEBHOOK_ID=

WISE_PROFILE_ID=
WISE_API_TOKEN=

PAYMENTS_RETURN_URL=https://your-domain.example/checkout/return
PAYMENTS_CANCEL_URL=https://your-domain.example/checkout/cancel

BANK_TRANSFER_INSTRUCTIONS=


# ------------------------------------------------------
# 11) EMAIL — SMTP (TRANSACTIONAL)
# ------------------------------------------------------
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=

SMTP_TLS=1
SMTP_SSL=0

# ✅ Preferido: un solo campo (tu app puede parsearlo)
SMTP_FROM=Skyline Store <no-reply@your-domain.example>

# Compat legacy (si tu app usa estos)
SMTP_FROM_EMAIL=no-reply@your-domain.example
SMTP_FROM_NAME=Skyline Store
SMTP_REPLY_TO=soporte@your-domain.example

SMTP_TIMEOUT=20
SMTP_RETRIES=2
SMTP_RETRY_SLEEP=1

EMAIL_SUBJECT_PREFIX=[Skyline]

# ✅ Mejora 10: bandera global para bloquear envío si faltan credenciales
EMAIL_REQUIRE_SMTP_CREDS=1


# ------------------------------------------------------
# 12) ROUTES AUTO REGISTER
# ------------------------------------------------------
ROUTES_DEBUG=0
ROUTES_STRICT=0
ROUTES_STRICT_FORCE=0
ROUTES_SCAN_SUBPACKAGES=0
ROUTES_IMPORT_NO_CACHE=0
ROUTES_SCAN_ONLY=0

ROUTES_REQUIRE=
ROUTES_DISABLE=
